@using ViewModel.Models.ResponseModels
@*
    Update date			Description 
	--------------------------------
    20251115            Initial
*@
@model ImageViewModel
@{
    ViewData["Title"] = "Image blur";
}

<h2>Original vs Processed Image</h2>

<form asp-action="Blur"
      enctype="multipart/form-data"
      id="imageForm">
    <input type="file"
           id="fileInput"
           name="imageFile"
           accept="image/*"
           style="position:absolute; left:-9999px;"
           onchange="previewAndSubmit(this)" />
    <label for="fileInput"
           style="
                    display:inline-block;
                    padding:10px 20px;
                    background-color:#007bff;
                    color:white;
                    border-radius:5px;
                    cursor:pointer;
                   ">Choose Image</label>
</form>

<img id="previewOriginal" style="display:none; max-width:300px; margin-bottom:10px;" />

@if (ViewBag.OriginalImage != null && ViewBag.ProcessedImage != null)
{
    <div style="display:flex; gap:40px; margin-top:10px;">
        <div>
            <p>Original Image</p>
            <img src="@ViewBag.OriginalImage" width="300" />
        </div>
        <div>
            <p>Processed Image</p>
            <img src="@ViewBag.ProcessedImage" width="300" />
        </div>
    </div>
}

@if (ViewBag.Error != null)
{
    <p style="color:red;">@ViewBag.Error</p>
}

@section Scripts {
    <script>
        function previewAndSubmit(input) {
            if (input.files && input.files[0]) {
                // Preview original image (optional, if you want instant preview before upload)
                var reader = new FileReader();
                reader.onload = function (e) {
                    // If you want to show preview before upload, add an <img id="previewOriginal" /> somewhere
                    var img = document.getElementById('previewOriginal');
                    if (img) {
                        img.src = e.target.result;
                        img.style.display = "block";
                    }
                };
                reader.readAsDataURL(input.files[0]);
                // Submit form automatically
                document.getElementById('imageForm').submit();
            }
        }
    </script>
}
